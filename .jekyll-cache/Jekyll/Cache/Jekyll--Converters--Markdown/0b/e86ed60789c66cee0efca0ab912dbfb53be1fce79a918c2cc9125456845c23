I"šò<ul id="markdown-toc">
  <li><a href="#defining-functions--å‡½æ•°å®šä¹‰" id="markdown-toc-defining-functions--å‡½æ•°å®šä¹‰">Defining functions â€“ å‡½æ•°å®šä¹‰</a>    <ul>
      <li><a href="#function-declarations--å‡½æ•°å£°æ˜" id="markdown-toc-function-declarations--å‡½æ•°å£°æ˜">Function declarations â€“ å‡½æ•°å£°æ˜</a></li>
      <li><a href="#function-expressions--å‡½æ•°è¡¨è¾¾å¼" id="markdown-toc-function-expressions--å‡½æ•°è¡¨è¾¾å¼">Function expressions â€“ å‡½æ•°è¡¨è¾¾å¼</a></li>
    </ul>
  </li>
  <li><a href="#calling-functions--è°ƒç”¨å‡½æ•°" id="markdown-toc-calling-functions--è°ƒç”¨å‡½æ•°">Calling functions â€“ è°ƒç”¨å‡½æ•°</a>    <ul>
      <li><a href="#å‚æ•°" id="markdown-toc-å‚æ•°">å‚æ•°</a></li>
      <li><a href="#javascriptå‡½æ•°æ²¡æœ‰é‡è½½" id="markdown-toc-javascriptå‡½æ•°æ²¡æœ‰é‡è½½">JavaScriptå‡½æ•°æ²¡æœ‰é‡è½½</a></li>
    </ul>
  </li>
  <li><a href="#thiså¯¹è±¡" id="markdown-toc-thiså¯¹è±¡">thiså¯¹è±¡</a>    <ul>
      <li><a href="#æ”¹å˜this" id="markdown-toc-æ”¹å˜this">æ”¹å˜this</a>        <ul>
          <li><a href="#callæ–¹æ³•" id="markdown-toc-callæ–¹æ³•">call()æ–¹æ³•</a></li>
          <li><a href="#applyæ–¹æ³•" id="markdown-toc-applyæ–¹æ³•">apply()æ–¹æ³•</a></li>
          <li><a href="#bindæ–¹æ³•" id="markdown-toc-bindæ–¹æ³•">bind()æ–¹æ³•</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#function-scope--å‡½æ•°ä½œç”¨åŸŸ" id="markdown-toc-function-scope--å‡½æ•°ä½œç”¨åŸŸ">Function scope â€“ å‡½æ•°ä½œç”¨åŸŸ</a></li>
  <li><a href="#scope-and-the-function-stack--ä½œç”¨åŸŸå’Œå‡½æ•°å †æ ˆ" id="markdown-toc-scope-and-the-function-stack--ä½œç”¨åŸŸå’Œå‡½æ•°å †æ ˆ">Scope and the function stack â€“ ä½œç”¨åŸŸå’Œå‡½æ•°å †æ ˆ</a>    <ul>
      <li><a href="#recursion--é€’å½’" id="markdown-toc-recursion--é€’å½’">Recursion â€“ é€’å½’</a></li>
      <li><a href="#nested-functions-and-closures--åµŒå¥—å‡½æ•°å’Œé—­åŒ…" id="markdown-toc-nested-functions-and-closures--åµŒå¥—å‡½æ•°å’Œé—­åŒ…">Nested functions and closures â€“ åµŒå¥—å‡½æ•°å’Œé—­åŒ…</a></li>
      <li><a href="#preservation-of-variables--ä¿å­˜å˜é‡" id="markdown-toc-preservation-of-variables--ä¿å­˜å˜é‡">Preservation of variables â€“ ä¿å­˜å˜é‡</a></li>
      <li><a href="#multiply-nested-functions--å¤šå±‚åµŒå¥—å‡½æ•°" id="markdown-toc-multiply-nested-functions--å¤šå±‚åµŒå¥—å‡½æ•°">Multiply-nested functions â€“ å¤šå±‚åµŒå¥—å‡½æ•°</a></li>
      <li><a href="#name-conflicts--å‘½åå†²çª" id="markdown-toc-name-conflicts--å‘½åå†²çª">Name conflicts â€“ å‘½åå†²çª</a></li>
    </ul>
  </li>
  <li><a href="#closures--é—­åŒ…" id="markdown-toc-closures--é—­åŒ…">Closures â€“ é—­åŒ…</a></li>
  <li><a href="#using-the-arguments-object--ä½¿ç”¨argumentså¯¹è±¡" id="markdown-toc-using-the-arguments-object--ä½¿ç”¨argumentså¯¹è±¡">Using the arguments object â€“ ä½¿ç”¨argumentså¯¹è±¡</a></li>
  <li><a href="#function-parameter--å‡½æ•°å‚æ•°" id="markdown-toc-function-parameter--å‡½æ•°å‚æ•°">Function parameter â€“ å‡½æ•°å‚æ•°</a>    <ul>
      <li><a href="#default-parameter" id="markdown-toc-default-parameter">default parameter</a></li>
      <li><a href="#rest-parameter" id="markdown-toc-rest-parameter">rest parameter</a></li>
    </ul>
  </li>
  <li><a href="#arrow-functions--ç®­å¤´å‡½æ•°" id="markdown-toc-arrow-functions--ç®­å¤´å‡½æ•°">Arrow functions â€“ ç®­å¤´å‡½æ•°</a>    <ul>
      <li><a href="#æ›´ç®€æ´çš„å‡½æ•°" id="markdown-toc-æ›´ç®€æ´çš„å‡½æ•°">æ›´ç®€æ´çš„å‡½æ•°</a></li>
      <li><a href="#thisçš„è¯æ³•" id="markdown-toc-thisçš„è¯æ³•">thisçš„è¯æ³•</a></li>
      <li><a href="#ç®­å¤´å‡½æ•°çš„è¯­æ³•" id="markdown-toc-ç®­å¤´å‡½æ•°çš„è¯­æ³•">ç®­å¤´å‡½æ•°çš„è¯­æ³•</a></li>
    </ul>
  </li>
  <li><a href="#iifeimmediately-invoked-function-expression--ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼" id="markdown-toc-iifeimmediately-invoked-function-expression--ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼">IIFE(Immediately Invoked Function Expression) â€“ ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼</a></li>
</ul>

<p>åœ¨<code class="highlighter-rouge">JavaScript</code>ä¸­ï¼Œå‡½æ•°å…¶å®å°±æ˜¯å¯¹è±¡ã€‚ä½¿å‡½æ•°ä¸åŒäºå…¶ä»–å¯¹è±¡çš„<em>å†³å®šæ€§</em>ç‰¹ç‚¹æ—¶<strong>å‡½æ•°å­˜åœ¨ä¸€ä¸ªè¢«ç§°ä¹‹ä¸º<code class="highlighter-rouge">[[Call]]</code>çš„å†…éƒ¨å±æ€§</strong>ã€‚å†…éƒ¨å±æ€§æ— æ³•é€šè¿‡ä»£ç è®¿é—®ï¼Œè€Œæ˜¯å®šä¹‰äº†ä»£ç æ‰§è¡Œæ—¶çš„è¡Œä¸ºã€‚</p>

<blockquote>
  <p><code class="highlighter-rouge">ECMAScript</code>ä¸ºå¯¹è±¡å®šä¹‰äº†å¤šç§å†…éƒ¨å±æ€§ï¼Œè¿™äº›å†…éƒ¨å±æ€§éƒ½ä½¿ç”¨<code class="highlighter-rouge">[[]]</code>æ¥æ ‡è®°ã€‚</p>
</blockquote>

<p><code class="highlighter-rouge">[[Call]]</code>å±æ€§æ˜¯å‡½æ•°ç‹¬æœ‰çš„ï¼Œè¡¨æ˜è¯¥å¯¹è±¡å¯ä»¥è¢«æ‰§è¡Œã€‚</p>

<p>ä½ å¯ä»¥åƒä½¿ç”¨å¯¹è±¡ä¸€æ ·ä½¿ç”¨å‡½æ•°ï¼Œå¯ä»¥å°†å®ƒä»¬èµ‹ç»™å˜é‡ï¼Œåœ¨å¯¹è±¡ä¸­æ·»åŠ å®ƒä»¬ï¼Œå°†å®ƒä»¬å½“æˆå‚æ•°ä¼ é€’ç»™åˆ«çš„å‡½æ•°ï¼Œæˆ–ä»åˆ«çš„å‡½æ•°ä¸­è¿”å›ã€‚å‡½æ•°å°±æ˜¯å€¼ã€‚</p>

<p>A function is a <code class="highlighter-rouge">JavaScript</code> procedure - <strong>a set of statements that performs a task or calculates a value</strong>.</p>

<!-- more -->

<h2 id="defining-functions--å‡½æ•°å®šä¹‰">Defining functions â€“ å‡½æ•°å®šä¹‰</h2>

<h3 id="function-declarations--å‡½æ•°å£°æ˜">Function declarations â€“ å‡½æ•°å£°æ˜</h3>

<p>A <strong>function definition</strong> (also called a <strong>function declaration</strong>, or <strong>function statement</strong>) consists of the <code class="highlighter-rouge">function</code> keyword, followed by:</p>

<ul>
  <li>The name of the function</li>
  <li>A list of arguments(å‚æ•°) to the function, enclosed in parentheses(æ‹¬å·) and separated by commas(é€—å·)</li>
  <li>The JavaScript statements that define the function, enclosed in curly brackets, <code class="highlighter-rouge">{ }</code></li>
</ul>

<blockquote>
  <p>æ³¨æ„ï¼šåœ¨<code class="highlighter-rouge">C++</code>è¯­è¨€ä¸­ï¼Œå‡½æ•°å£°æ˜å’Œå®šä¹‰å¯æ˜¯ä¸¤ç äº‹å“¦ï¼Œè¦è®°æ¸…æ¥šå“¦ã€‚</p>
</blockquote>

<p>å‚æ•°ä»¥<strong>å€¼ä¼ é€’</strong>çš„æ–¹å¼ä¼ é€’ç»™è¢«è°ƒå‡½æ•°(æ¯”å¦‚<code class="highlighter-rouge">a number</code>)ï¼Œå¦‚æœè¢«è°ƒå‡½æ•°æ”¹å˜äº†è¿™ä¸ªå‚æ•°çš„å€¼ï¼Œè¿™æ ·çš„æ”¹å˜ä¸ä¼šå½±å“åˆ°å…¨å±€æˆ–è°ƒç”¨å‡½æ•°ã€‚</p>

<p>ä½†æ˜¯ï¼Œå¦‚æœ<code class="highlighter-rouge">object</code>ä½œä¸ºå‚æ•°ä¼ é€’(æ¯”å¦‚<code class="highlighter-rouge">Array</code>ã€<code class="highlighter-rouge">user-defined object</code>)ï¼Œè€Œå‡½æ•°æ”¹å˜äº†è¯¥å¯¹è±¡çš„å±æ€§ï¼Œåˆ™è¿™ç§æ”¹å˜å¯¹å¤–æ˜¯å¯è§çš„ã€‚</p>

<blockquote>
  <p>å‡½æ•°å£°æ˜ä¼šè¢«æå‡è‡³ä¸Šä¸‹æ–‡çš„é¡¶éƒ¨ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å…ˆä½¿ç”¨å‡½æ•°åå£°æ˜å®ƒä»¬ã€‚</p>
</blockquote>

<h3 id="function-expressions--å‡½æ•°è¡¨è¾¾å¼">Function expressions â€“ å‡½æ•°è¡¨è¾¾å¼</h3>

<p>Functions can also be created by a function expression.(å‡½æ•°åŒæ ·å¯ä»¥ç”±å‡½æ•°è¡¨è¾¾å¼åˆ›å»º) Such a function can be <strong>anonymous</strong>(åŒ¿åçš„); it does not have to have a name.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">square</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">number</span><span class="p">)</span> <span class="p">(</span><span class="k">return</span> <span class="nx">number</span> <span class="o">*</span> <span class="nx">number</span><span class="p">;)</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">square</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="c1">// x gets the value 16</span>
</code></pre></div></div>

<p>However, a name can be provided with a function expression and can be used inside the function to refer to itself, or in a debugger to identify the function in stack traces:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">factorial</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">fac</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">fac</span><span class="p">(</span><span class="nx">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);}</span>
</code></pre></div></div>

<p>Function expressions are convenient when passing a function as an argument to another function.(å½“å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°è¡¨è¾¾å¼å°±ååˆ†æ–¹ä¾¿)</p>

<blockquote>
  <p>å½“ä¸€ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œç§°ä¹‹ä¸º<strong>æ–¹æ³•</strong>ã€‚</p>
</blockquote>

<hr />

<h2 id="calling-functions--è°ƒç”¨å‡½æ•°">Calling functions â€“ è°ƒç”¨å‡½æ•°</h2>

<p>Functions must be in scope when they are called, but the function declaration can be hoisted (appear below the call in the code).(å‡½æ•°å¿…é¡»åœ¨è¢«ä»–ä»¬è¢«è°ƒç”¨çš„åŸŸå½“ä¸­ï¼Œä½†æ˜¯å‡½æ•°å£°æ˜å¯ä»¥è¢«æå‡â€“å‡ºç°åœ¨è°ƒç”¨ä»£ç çš„ä¸‹æ–¹)</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="p">(</span><span class="nx">square</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>
<span class="cm">/* ... */</span>
<span class="kd">function</span> <span class="nx">square</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">n</span><span class="p">;}</span>
</code></pre></div></div>

<blockquote>
  <p>The scope of a function is the function in which it is declared, or the entire program if it is declared at the top level.</p>
</blockquote>

<blockquote>
  <p>æ³¨æ„ï¼š å‡½æ•°æå‡åªå¯¹å‡½æ•°å£°æ˜æœ‰æ•ˆï¼Œå¯¹å‡½æ•°è¡¨è¾¾å¼æ˜¯æ— æ•ˆçš„ã€‚</p>
</blockquote>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">square</span><span class="p">);</span> <span class="c1">// square is hoisted with an initial value undefined.</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">square</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="c1">// TypeError: square is not a function</span>
<span class="kd">var</span> <span class="nx">square</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">n</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p><strong>å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡</strong>ï¼Œä¹Ÿæœ‰è‡ªå·±çš„<strong>æ–¹æ³•</strong>ã€‚<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function">å…·ä½“å‚è§</a></p>
</blockquote>

<p>åœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæ—¶åˆ»è®°ä½å‡½æ•°å°±æ˜¯å¯¹è±¡ï¼Œå¾ˆå¤šè¡Œä¸ºå°±å˜å¾—å®¹æ˜“ç†è§£äº†ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥å°†å‡½æ•°å½“ä½œå‚æ•°ä¼ é€’ç»™å…¶ä»–çš„å‡½æ•°ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">];</span>
<span class="nx">numbers</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">second</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">first</span> <span class="o">-</span> <span class="nx">second</span><span class="p">;</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">numbers</span><span class="p">);</span> <span class="c1">//"[1,2,4,5,6,7,8,10]"</span>

<span class="nx">numbers</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">numbers</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">numbers</span><span class="p">);</span><span class="c1">//"[1,10,2,4,5,6,7,8]"</span>
</code></pre></div></div>

<blockquote>
  <p>æ­¤å¤„ï¼Œè¢«ä¼ é€’ç»™<code class="highlighter-rouge">sort()</code>çš„æ¯”è¾ƒå‡½æ•°å…¶å®æ˜¯ä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼ï¼Œæ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚è‹¥ä½¿ç”¨é»˜è®¤çš„æ¯”è¾ƒå‡½æ•°ï¼Œä¼šå°†æ‰€æœ‰çš„å€¼éƒ½è½¬æ¢æˆå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚</p>
</blockquote>

<h3 id="å‚æ•°">å‚æ•°</h3>

<p>å‡½æ•°çš„å¦ä¸€ä¸ªç‹¬ç‰¹ä¹‹å¤„åœ¨äºä½ å¯ä»¥ç»™å‡½æ•°ä¼ é€’ä»»æ„æ•°é‡çš„å‚æ•°å´ä¸é€ æˆé”™è¯¯ã€‚é‚£æ˜¯å› ä¸ºå‡½æ•°å‚æ•°å®é™…ä¸Šè¢«ä¿å­˜åœ¨ä¸€ä¸ªç§°ä¸º<code class="highlighter-rouge">arguments</code>çš„<em>ç±»ä¼¼æ•°ç»„</em>(ä¸æ˜¯æ•°ç»„)çš„å¯¹è±¡ä¸­ï¼Œå¯ä»¥è‡ªç”±å¢é•¿åŒ…å«ä»»æ„ä¸ªæ•°çš„å€¼ï¼Œè¿™äº›å€¼å¯é€šè¿‡æ•°å­—ç´¢å¼•æ¥å¼•ç”¨ã€‚<code class="highlighter-rouge">arguments</code>çš„<code class="highlighter-rouge">length</code>å±æ€§ä¼šå‘Šè¯‰ä½ ç›®å‰æœ‰å¤šå°‘ä¸ªå€¼ã€‚</p>

<p><code class="highlighter-rouge">arguments</code>å¯¹è±¡è‡ªåŠ¨å­˜åœ¨äºå‡½æ•°ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°çš„å‘½åå‚æ•°ä¸è¿‡æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œå¹¶ä¸çœŸæ­£é™åˆ¶äº†è¯¥å‡½æ•°å¯æ¥å—å‚æ•°çš„ä¸ªæ•°ã€‚</p>

<p>å¦ä¸€æ–¹é¢ï¼Œ<code class="highlighter-rouge">JavaScript</code>ä¹Ÿæ²¡æœ‰å¿½è§†é‚£ä¹ˆå‘½åå‚æ•°ã€‚å‡½æ•°æœŸæœ›çš„å‚æ•°ä¸ªæ•°ä¿å­˜åœ¨å‡½æ•°çš„<code class="highlighter-rouge">length</code>å±æ€§ä¸­ã€‚å› ä¸ºå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿå…·æœ‰å±æ€§ï¼Œä»è€Œæˆ‘ä»¬ä¸å¿…å¤§æƒŠå°æ€ªã€‚</p>

<blockquote>
  <p>æ³¨æ„ï¼šä¸€ä¸ªæ˜¯å¯¹è±¡<code class="highlighter-rouge">arguments</code>çš„<code class="highlighter-rouge">length</code>å±æ€§ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°<code class="highlighter-rouge">function</code>çš„<code class="highlighter-rouge">length</code>å±æ€§ã€‚</p>
</blockquote>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">reflect</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reflect</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hi!</span><span class="dl">"</span><span class="p">));</span>  <span class="c1">//"Hi!"</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reflect</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hi!</span><span class="dl">"</span><span class="p">,</span> <span class="mi">25</span><span class="p">));</span>  <span class="c1">//"Hi!"</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reflect</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>  <span class="c1">//è¿”å›å‡½æ•°æœŸæœ›çš„å‚æ•°ä¸ªæ•°ï¼š"1"</span>

<span class="nx">reflect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reflect</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hi!</span><span class="dl">"</span><span class="p">));</span>  <span class="c1">//è¿”å›ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•° "Hi!"</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reflect</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hi!</span><span class="dl">"</span><span class="p">,</span> <span class="mi">25</span><span class="p">));</span>  <span class="c1">//è¿”å›ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°"Hi!"</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reflect</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>  <span class="c1">//è¿”å›å‡½æ•°æœŸæœ›çš„å‚æ•°ä¸ªæ•°ï¼š"0"</span>
</code></pre></div></div>

<p>åœ¨æŸäº›åœºåˆï¼Œä½¿ç”¨<code class="highlighter-rouge">arguments</code>æ¯”å‘½åå‚æ•°æ›´æœ‰æ•ˆã€‚æ¯”å¦‚ï¼šä½ ä¸çŸ¥é“ä¼šæœ‰å¤šå°‘ä¸ªå‚æ•°ï¼Œæ‰€ä»¥ä½ æ— æ³•ä½¿ç”¨å‘½åå‚æ•°ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sum</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">len</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

  <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">){</span>
    <span class="nx">result</span> <span class="o">+=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="o">++</span><span class="nx">i</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span>  <span class="c1">//4</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span>  <span class="c1">//6</span>
</code></pre></div></div>

<h3 id="javascriptå‡½æ•°æ²¡æœ‰é‡è½½">JavaScriptå‡½æ•°æ²¡æœ‰é‡è½½</h3>

<p>å¤§å¤šæ•°è¯­è¨€éƒ½æ”¯æŒé‡è½½ï¼Œä½†ä¸Šé¢ä¹Ÿæåˆ°ï¼Œ<code class="highlighter-rouge">JavaScript</code>å‡½æ•°å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ä¸”å‚æ•°ç±»å‹å®Œå…¨æ²¡æœ‰é™åˆ¶ã€‚è¿™è¯´æ˜<code class="highlighter-rouge">JavaScript</code>å‡½æ•°å…¶å®æ ¹æœ¬æ²¡æœ‰ç­¾å(signature)ï¼Œå› æ­¤ä¹Ÿä¸å­˜åœ¨é‡è½½ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sayMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">sayMessage</span><span class="p">(){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Default message</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">sayMesssage</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello!</span><span class="dl">"</span><span class="p">);</span>  <span class="c1">//"Default message"</span>
</code></pre></div></div>

<blockquote>
  <p>è¿™è¯´æ˜ï¼Œå½“è¯•å›¾å®šä¹‰å¤šä¸ªåŒåå‡½æ•°æ—¶ï¼Œåªæœ‰æœ€åå®šä¹‰çš„æ˜¯æœ‰æ•ˆçš„ï¼Œä¹‹å‰çš„å‡½æ•°å£°æ˜è¢«å®Œå…¨åˆ é™¤ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¯¹è±¡æ¥å¸®åŠ©ç†è§£ï¼š</p>
</blockquote>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">sayMessage</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="dl">"</span><span class="s2">message</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">console.log(message);</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">sayMessage</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="dl">"</span><span class="s2">console.log(</span><span class="dl">"</span><span class="nx">Default</span> <span class="nx">message</span><span class="dl">"</span><span class="s2">);</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">sayMessage</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello!</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<p>ä½†è¿™å¹¶ä¸æ˜¯è¯´<code class="highlighter-rouge">JavaScript</code>ä¸èƒ½<em>æ¨¡ä»¿å‡½æ•°é‡è½½</em>ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="highlighter-rouge">arguments</code>å¯¹è±¡è·å–æ‰€ä¼ å…¥çš„å‚æ•°ä¸ªæ•°(<code class="highlighter-rouge">arguments.length</code>)ï¼Œç„¶åå†³å®šå¦‚ä½•å¤„ç†ã€‚</p>

<hr />

<h2 id="thiså¯¹è±¡">thiså¯¹è±¡</h2>

<p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Nicholas</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">sayName</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>æˆ‘ä»¬ä¹‹å‰æåˆ°ï¼Œå¦‚æœ<strong>å±æ€§å€¼æ˜¯å‡½æ•°</strong>ï¼Œåˆ™è¯¥å±æ€§å°±è¢«ç§°ä¸º<strong>æ–¹æ³•</strong>ã€‚å®šä¹‰å¥½ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code class="highlighter-rouge">person.sayName()</code>è¿›è¡Œè°ƒç”¨ã€‚</p>

<p>ä½†æ˜¯é—®é¢˜ä¹‹å¤„åœ¨äºï¼Œ<code class="highlighter-rouge">sayName()</code>æ–¹æ³•ç›´æ¥å¼•ç”¨äº†<code class="highlighter-rouge">persion.name</code>ï¼Œåœ¨æ–¹æ³•å’Œå¯¹è±¡é—´å»ºç«‹äº†<em>ç´§è€¦åˆ</em>ã€‚</p>

<p><code class="highlighter-rouge">JavaScript</code>æ‰€æœ‰çš„å‡½æ•°ä½œç”¨åŸŸå†…éƒ½æœ‰ä¸€ä¸ª<code class="highlighter-rouge">this</code>å¯¹è±¡ä»£è¡¨<strong>è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡</strong>ã€‚åœ¨å…¨å±€ä½œç”¨åŸŸå†…ï¼Œ<code class="highlighter-rouge">this</code>ä»£è¡¨å…¨å±€å¯¹è±¡(æµè§ˆå™¨é‡Œçš„<code class="highlighter-rouge">window</code>)ï¼Œå½“ä¸€ä¸ªå‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œé»˜è®¤<code class="highlighter-rouge">this</code>çš„å€¼ç­‰äºé‚£ä¸ªå¯¹è±¡ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Nicholas</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">sayName</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="æ”¹å˜this">æ”¹å˜this</h3>

<p>ä¸€èˆ¬<code class="highlighter-rouge">this</code>ä¼šè¢«è‡ªåŠ¨è®¾ç½®ï¼Œä½†æ˜¯å¯ä»¥æ”¹å˜å®ƒçš„å€¼æ¥å®Œæˆä¸åŒçš„ç›®æ ‡ã€‚æœ‰ä¸‰ç§æ–¹æ³•ï¼š</p>

<h4 id="callæ–¹æ³•">call()æ–¹æ³•</h4>

<p><code class="highlighter-rouge">call()</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†å‡½æ•°æ‰§è¡Œæ—¶<code class="highlighter-rouge">this</code>çš„å€¼ï¼Œå…¶åæ‰€æœ‰å‚æ•°éƒ½æ˜¯éœ€è¦è¢«ä¼ å…¥å‡½æ•°çš„å‚æ•°ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sayNameForAll</span><span class="p">(</span><span class="nx">label</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">label</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">:</span><span class="dl">"</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">person1</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span><span class="dl">"</span><span class="s2">Nicholas</span><span class="dl">"</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">person2</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span><span class="dl">"</span><span class="s2">Greg</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Micael</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">sayNameForAll</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="dl">"</span><span class="s2">global</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//"global:Micael"</span>
<span class="nx">sayNameForAll</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">person1</span><span class="p">,</span> <span class="dl">"</span><span class="s2">person1</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//"person1:Nicholas"</span>
<span class="nx">sayNameForAll</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">person2</span><span class="p">,</span> <span class="dl">"</span><span class="s2">person2</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//"preson2:Greg"</span>
</code></pre></div></div>

<blockquote>
  <p>æ³¨æ„ï¼šè°ƒç”¨å‡½æ•°æ—¶åœ¨å‡½æ•°ååæ²¡æœ‰å°æ‹¬å·ï¼Œ<strong>å› ä¸ºå®ƒè¢«ä½œä¸ºå¯¹è±¡è®¿é—®è€Œä¸æ˜¯è¢«æ‰§è¡Œçš„ä»£ç </strong>ã€‚</p>
</blockquote>

<h4 id="applyæ–¹æ³•">apply()æ–¹æ³•</h4>

<p>ä¸<code class="highlighter-rouge">call()</code>ç±»ä¼¼ï¼Œåªä¸è¿‡ç¬¬äºŒä¸ªå‚æ•°æ¥å—ä¸€ä¸ªæ•°ç»„æˆ–è€…ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚å“ˆå“ˆï¼Œæ²¡é”™ï¼Œå°±æ˜¯<code class="highlighter-rouge">arguments</code>å¯¹è±¡ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sayNameForAll</span><span class="p">(</span><span class="nx">label</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">label</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">:</span><span class="dl">"</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">person1</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span><span class="dl">"</span><span class="s2">Nicholas</span><span class="dl">"</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">person2</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span><span class="dl">"</span><span class="s2">Greg</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Micael</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">sayNameForAll</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="dl">"</span><span class="s2">global</span><span class="dl">"</span><span class="p">]);</span> <span class="c1">//"global:Micael"</span>
<span class="nx">sayNameForAll</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">person1</span><span class="p">,</span> <span class="p">[</span><span class="dl">"</span><span class="s2">person1</span><span class="dl">"</span><span class="p">]);</span> <span class="c1">//"person1:Nicholas"</span>
<span class="nx">sayNameForAll</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">person2</span><span class="p">,</span> <span class="p">[</span><span class="dl">"</span><span class="s2">person2</span><span class="dl">"</span><span class="p">]);</span> <span class="c1">//"preson2:Greg"</span>
</code></pre></div></div>

<blockquote>
  <p>å¦‚æœä½ æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œç”¨<code class="highlighter-rouge">apply()</code>ï¼Œå¦‚æœä½ åªæœ‰ä¸€ä¸ªå•ç‹¬çš„å˜é‡ï¼Œåˆ™ç”¨<code class="highlighter-rouge">call()</code>ã€‚</p>
</blockquote>

<h4 id="bindæ–¹æ³•">bind()æ–¹æ³•</h4>

<p>çœ‹ä¾‹å­ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sayNameForAll</span><span class="p">(</span><span class="nx">label</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">label</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">:</span><span class="dl">"</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">person1</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span><span class="dl">"</span><span class="s2">Nicholas</span><span class="dl">"</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">person2</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span><span class="dl">"</span><span class="s2">Greg</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">sayNameForPerson1</span> <span class="o">=</span> <span class="nx">sayNameForAll</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">person1</span><span class="p">);</span>
<span class="nx">sayNameForPerson1</span><span class="p">(</span><span class="dl">"</span><span class="s2">person1</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//"person1:Nicholas"</span>

<span class="kd">var</span> <span class="nx">sayNameForPerson2</span> <span class="o">=</span> <span class="nx">sayNameForAll</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">person2</span><span class="p">,</span><span class="dl">"</span><span class="s2">person2</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">sayNameForPerson2</span><span class="p">();</span> <span class="c1">//"person2:Greg"</span>

<span class="nx">person2</span><span class="p">.</span><span class="nx">sayName</span> <span class="o">=</span> <span class="nx">sayNameForPerson1</span><span class="p">;</span>
<span class="nx">person2</span><span class="p">.</span><span class="nx">sayName</span> <span class="p">(</span><span class="dl">"</span><span class="s2">person2</span><span class="dl">"</span><span class="p">);</span>    <span class="c1">//"person2:Nicholas"</span>
</code></pre></div></div>

<blockquote>
  <p><code class="highlighter-rouge">sayNameForPerson1()</code>æ²¡æœ‰ç»‘å®šå‚æ•°ï¼Œæ‰€ä»¥ä½ éœ€è¦ä¼ å…¥<code class="highlighter-rouge">label</code>å‚æ•°ç”¨äºè¾“å‡ºï¼›<code class="highlighter-rouge">sayNameForPerson2()</code>ä¸ä»…ç»‘å®š<code class="highlighter-rouge">this</code>ä¸º<code class="highlighter-rouge">person2</code>ï¼ŒåŒæ—¶ä¹Ÿç»‘å®šäº†ç¬¬ä¸€ä¸ªå‚æ•°ä¸º<code class="highlighter-rouge">person2</code>ï¼Œé‚£ä¹ˆä½ è°ƒç”¨<code class="highlighter-rouge">sayNameForPerson2()</code>å°±ä¸éœ€ä¼ å…¥å‚æ•°ï¼›ä¾‹å­æœ€åå°†<code class="highlighter-rouge">sayNameForPerson1()</code>è®¾ç½®ä¸º<code class="highlighter-rouge">person2</code>çš„<code class="highlighter-rouge">sayName</code>æ–¹æ³•ï¼Œç”±äº<code class="highlighter-rouge">this</code>çš„å€¼å·²ç»ç»‘å®šï¼Œæ‰€ä»¥è¾“å‡ºä»ç„¶æ˜¯<code class="highlighter-rouge">person.name</code>çš„å€¼ã€‚</p>
</blockquote>

<hr />

<h2 id="function-scope--å‡½æ•°ä½œç”¨åŸŸ">Function scope â€“ å‡½æ•°ä½œç”¨åŸŸ</h2>

<ul>
  <li>å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨çš„å˜é‡ä¸èƒ½è¢«å¤–éƒ¨è®¿é—®ï¼Œå› ä¸ºè¿™ä¸ªå˜é‡ä»…ä»…åœ¨å‡½æ•°å†…æœ‰å®šä¹‰</li>
  <li>å‡½æ•°è¢«å®šä¹‰ä¸º<strong>å…¨å±€</strong>ï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®æ‰€æœ‰çš„<strong>å…¨å±€å˜é‡</strong></li>
  <li>åœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­å®šä¹‰çš„å‡½æ•°å¯ä»¥è®¿é—®åœ¨å…¶çˆ¶å‡½æ•°ä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡å’Œçˆ¶å‡½æ•°æœ‰æƒè®¿é—®çš„å˜é‡</li>
</ul>

<hr />

<h2 id="scope-and-the-function-stack--ä½œç”¨åŸŸå’Œå‡½æ•°å †æ ˆ">Scope and the function stack â€“ ä½œç”¨åŸŸå’Œå‡½æ•°å †æ ˆ</h2>

<h3 id="recursion--é€’å½’">Recursion â€“ é€’å½’</h3>

<p>å‡½æ•°å¯ä»¥æŒ‡å‘å’Œè°ƒç”¨è‡ªèº«ï¼Œæœ‰ä¸‰ç§æ–¹æ³•ï¼š</p>

<ul>
  <li>ä½¿ç”¨å‡½æ•°å</li>
  <li><code class="highlighter-rouge">arguments.callee</code> â€“ è¿™ä¸ªå±æ€§åŒ…å«å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ï¼Œè¢«<code class="highlighter-rouge">ES5</code>ä¸¥æ ¼æ¨¡å¼åˆ é™¤</li>
  <li>ä½œç”¨åŸŸå†…æŒ‡å‘å‡½æ•°çš„å˜é‡å(æŒ‡ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„æ–¹å¼)</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">bar</span><span class="p">()</span> <span class="p">{</span>
   <span class="c1">// statements go here</span>
<span class="p">};</span>
</code></pre></div></div>

<p>The following are all equivalent:</p>

<ul>
  <li><code class="highlighter-rouge">bar()</code></li>
  <li><code class="highlighter-rouge">arguments.callee()</code></li>
  <li><code class="highlighter-rouge">foo()</code></li>
</ul>

<p>A function that calls itself is called a <em>recursive</em> function.</p>

<blockquote>
  <p>å°†é€’å½’ç®—æ³•è½¬æ¢æˆéé€’å½’æ˜¯å¯èƒ½çš„ï¼Œä½†é€»è¾‘æ›´å¤æ‚ï¼Œä¹Ÿä¼šéœ€è¦ä½¿ç”¨åˆ°<strong>å †æ ˆ</strong>ã€‚</p>
</blockquote>

<h3 id="nested-functions-and-closures--åµŒå¥—å‡½æ•°å’Œé—­åŒ…">Nested functions and closures â€“ åµŒå¥—å‡½æ•°å’Œé—­åŒ…</h3>

<p>å¯ä»¥åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢åµŒå¥—å¦å¤–ä¸€ä¸ªå‡½æ•°ã€‚<strong>åµŒå¥—ï¼ˆå†…éƒ¨ï¼‰å‡½æ•°</strong>å¯¹å…¶<strong>å®¹å™¨ï¼ˆå¤–éƒ¨ï¼‰å‡½æ•°</strong>æ˜¯ç§æœ‰çš„ã€‚å®ƒè‡ªèº«ä¹Ÿå½¢æˆäº†ä¸€ä¸ª<strong>é—­åŒ…</strong>(<code class="highlighter-rouge">closure</code>)ã€‚A closure is an expression (typically a function) that can have free variables together with an environment that binds those variables (that â€œclosesâ€ the expression).<strong>ä¸€ä¸ªé—­åŒ…æ˜¯ä¸€ä¸ªå¯ä»¥è‡ªå·±æ‹¥æœ‰ç‹¬ç«‹çš„ç¯å¢ƒä¸å˜é‡çš„çš„è¡¨è¾¾å¼(é€šå¸¸æ˜¯å‡½æ•°)</strong>ã€‚</p>

<p>æ—¢ç„¶<strong>åµŒå¥—å‡½æ•°æ˜¯ä¸€ä¸ªé—­åŒ…</strong>ï¼Œå°±æ„å‘³ç€ä¸€ä¸ªåµŒå¥—å‡½æ•°å¯ä»¥â€ç»§æ‰¿â€œå®¹å™¨å‡½æ•°çš„å‚æ•°å’Œå˜é‡ã€‚æ¢å¥è¯è¯´ï¼Œå†…éƒ¨å‡½æ•°åŒ…å«å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸã€‚</p>

<ul>
  <li>å†…éƒ¨å‡½æ•°åªèƒ½åœ¨å¤–éƒ¨å‡½æ•°ä¸­è®¿é—®</li>
  <li>å†…éƒ¨å‡½æ•°å½¢æˆä¸€ä¸ªé—­åŒ…ï¼š å†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å‚æ•°å’Œå˜é‡ï¼Œåä¹‹åˆ™ä¸è¡Œ</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">outside</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nx">inside</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">inside</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">fn_inside</span> <span class="o">=</span> <span class="nx">outside</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// Think of it like: give me a function that adds 3 to whatever you give it</span>
<span class="nx">result</span> <span class="o">=</span> <span class="nx">fn_inside</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="c1">// returns 8</span>

<span class="nx">result1</span> <span class="o">=</span> <span class="nx">outside</span><span class="p">(</span><span class="mi">3</span><span class="p">)(</span><span class="mi">5</span><span class="p">);</span> <span class="c1">// returns 8</span>
</code></pre></div></div>

<blockquote>
  <p>å› ä¸ºå½¢æˆé—­åŒ…ï¼Œæ‰€ä»¥ä½ å¯ä»¥è°ƒç”¨å¤–éƒ¨å‡½æ•°å¹¶æœªå¤–éƒ¨å’Œå†…éƒ¨å‡½æ•°æŒ‡å®šå‚æ•°</p>
</blockquote>

<h3 id="preservation-of-variables--ä¿å­˜å˜é‡">Preservation of variables â€“ ä¿å­˜å˜é‡</h3>

<p>ä¸€ä¸ªé—­åŒ…å¿…é¡»ä¿å­˜å®ƒèŒƒå›´å†…çš„æ‰€æœ‰å‚æ•°å’Œå˜é‡ã€‚</p>

<h3 id="multiply-nested-functions--å¤šå±‚åµŒå¥—å‡½æ•°">Multiply-nested functions â€“ å¤šå±‚åµŒå¥—å‡½æ•°</h3>

<p>Functions can be multiply-nested.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">A</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nx">B</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">C</span><span class="p">(</span><span class="nx">z</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">z</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">C</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">B</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">A</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// logs 6 (1 + 2 + 3)</span>
</code></pre></div></div>

<ul>
  <li>Bå½¢æˆäº†ä¸€ä¸ªåŒ…å«Açš„é—­åŒ…ï¼ŒBå¯ä»¥è®¿é—®Açš„å‚æ•°å’Œå˜é‡</li>
  <li>Cå½¢æˆä¸€ä¸ªåŒ…å«Bçš„é—­åŒ…</li>
  <li>æ‰€ä»¥ï¼ŒCå¯ä»¥è®¿é—®Aå’ŒBçš„ä»»ä½•å‚æ•°å’Œå˜é‡</li>
  <li>åä¹‹åˆ™ä¸è¡Œ</li>
</ul>

<blockquote>
  <p>è¿™ç§é€’å½’å¼æˆä¸º<strong>åŸŸé“¾</strong>(scope chaining)</p>
</blockquote>

<h3 id="name-conflicts--å‘½åå†²çª">Name conflicts â€“ å‘½åå†²çª</h3>

<p>When two arguments or variables in the scopes of a closure have the same name, there is a <code class="highlighter-rouge">name conflict</code>. More inner scopes take precedence, so the inner-most scope takes the highest precedence, while the outer-most scope takes the lowest(æ›´è¿‘çš„ä½œç”¨åŸŸæœ‰æ›´é«˜çš„ä¼˜å…ˆæƒï¼Œæ‰€ä»¥æœ€è¿‘çš„ä¼˜å…ˆæƒæœ€é«˜ï¼Œæœ€è¿œçš„æœ€ä½). This is the <strong>scope chain</strong>. The first on the chain is the inner-most scope, and the last is the outer-most scope(é“¾çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æœ€é‡Œé¢çš„åŸŸï¼Œæœ€åä¸€ä¸ªå…ƒç´ æ˜¯æœ€å¤–å±‚çš„åŸŸ).</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">outside</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="kd">function</span> <span class="nx">inside</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">inside</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">result</span> <span class="o">=</span> <span class="nx">outside</span><span class="p">()(</span><span class="mi">20</span><span class="p">);</span> <span class="c1">// returns 20 instead of 10</span>
</code></pre></div></div>

<blockquote>
  <p>å‘½åå†²çªå‘ç”Ÿåœ¨<code class="highlighter-rouge">return x</code>ï¼Œæ­¤æ—¶<code class="highlighter-rouge">inside()</code>å‚æ•°<code class="highlighter-rouge">x</code>ä¸<code class="highlighter-rouge">outside()</code>çš„å˜é‡<code class="highlighter-rouge">x</code>å‘ç”Ÿäº†å†²çªã€‚æ­¤æ—¶åŸŸé“¾æ˜¯<code class="highlighter-rouge">{inside,outside,global object}</code>ï¼Œæ‰€ä»¥<code class="highlighter-rouge">inside()</code>çš„<code class="highlighter-rouge">x</code>æœ‰æœ€é«˜çš„ä¼˜å…ˆæƒï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯ä¼ é€’ç»™å†…éƒ¨å‡½æ•°çš„<code class="highlighter-rouge">20</code>ã€‚</p>
</blockquote>

<hr />

<h2 id="closures--é—­åŒ…">Closures â€“ é—­åŒ…</h2>

<p>é—­åŒ…æ˜¯JavaScriptä¸­æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€ã€‚JavaScriptå…è®¸å‡½æ•°åµŒå¥—ï¼Œå¹¶ä¸”å†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å®šä¹‰åœ¨å¤–éƒ¨å‡½æ•°ä¸­çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°ï¼Œä»¥åŠå¤–éƒ¨å‡½æ•°èƒ½è®¿é—®çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°ã€‚ä½†æ˜¯ï¼Œå¤–éƒ¨å‡½æ•°å´ä¸èƒ½å¤Ÿè®¿é—®å®šä¹‰åœ¨å†…éƒ¨å‡½æ•°ä¸­çš„å˜é‡å’Œå‡½æ•°ã€‚è¿™ç»™å†…éƒ¨å‡½æ•°çš„å˜é‡æä¾›äº†ä¸€å®šçš„å®‰å…¨æ€§ã€‚è€Œä¸”ï¼Œå½“å†…éƒ¨å‡½æ•°ç”Ÿå­˜å‘¨æœŸå¤§äºå¤–éƒ¨å‡½æ•°æ—¶ï¼Œç”±äºå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸï¼Œå®šä¹‰åœ¨å¤–éƒ¨å‡½æ•°çš„å˜é‡å’Œå‡½æ•°çš„ç”Ÿå­˜å‘¨æœŸå°±ä¼šå¤§äºå¤–éƒ¨å‡½æ•°æœ¬èº«ã€‚<strong>å½“å†…éƒ¨å‡½æ•°ä»¥æŸä¸€ç§æ–¹å¼è¢«ä»»ä½•ä¸€ä¸ªå¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸè®¿é—®æ—¶ï¼Œä¸€ä¸ªé—­åŒ…å°±äº§ç”Ÿäº†</strong>ã€‚</p>

<p>å¤–éƒ¨å‡½æ•°çš„å‚æ•°å’Œå˜é‡å¯¹å†…åµŒå‡½æ•°æ¥è¯´æ˜¯å¯å–å¾—çš„ï¼Œè€Œé™¤äº†é€šè¿‡å†…åµŒå‡½æ•°æœ¬èº«ï¼Œæ²¡æœ‰å…¶å®ƒä»»ä½•æ–¹æ³•å¯ä»¥å–å¾—å†…åµŒçš„å˜é‡ã€‚å†…åµŒå‡½æ•°çš„å†…åµŒå˜é‡å°±åƒå†…åµŒå‡½æ•°çš„ä¿é™©æŸœã€‚å®ƒä»¬ä¼šä¸ºå†…åµŒå‡½æ•°ä¿ç•™<em>ç¨³å®š</em>è€Œåˆå®‰å…¨çš„æ•°æ®å‚ä¸è¿è¡Œã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">pet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>          <span class="c1">//å¤–éƒ¨å‡½æ•°å®šä¹‰äº†ä¸€ä¸ªå˜é‡"name"</span>
  <span class="kd">var</span> <span class="nx">getName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//å†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—® å¤–éƒ¨å‡½æ•°å®šä¹‰çš„"name"</span>
    <span class="k">return</span> <span class="nx">name</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">//è¿”å›è¿™ä¸ªå†…éƒ¨å‡½æ•°ï¼Œä»è€Œå°†å…¶æš´éœ²åœ¨å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸ</span>
  <span class="k">return</span> <span class="nx">getName</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">myPet</span> <span class="o">=</span> <span class="nx">pet</span><span class="p">(</span><span class="dl">"</span><span class="s2">Vivie</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">myPet</span><span class="p">();</span>                            <span class="c1">// è¿”å›ç»“æœ "Vivie"</span>
</code></pre></div></div>

<p>é—­åŒ…ä¸­çš„ç¥å¥‡å˜é‡<code class="highlighter-rouge">this</code>æ˜¯éå¸¸è¯¡å¼‚çš„ã€‚ä½¿ç”¨å®ƒå¿…é¡»ååˆ†çš„å°å¿ƒï¼Œå› ä¸º<code class="highlighter-rouge">this</code>æŒ‡ä»£ä»€ä¹ˆå®Œå…¨å–å†³äº<strong>å‡½æ•°åœ¨ä½•å¤„è¢«è°ƒç”¨</strong>ï¼Œè€Œä¸æ˜¯åœ¨ä½•å¤„è¢«å®šä¹‰ã€‚</p>

<hr />

<h2 id="using-the-arguments-object--ä½¿ç”¨argumentså¯¹è±¡">Using the arguments object â€“ ä½¿ç”¨argumentså¯¹è±¡</h2>

<p>å‡½æ•°çš„å‚æ•°è¢«ä¿å­˜ä¸ºä¸€ä¸ªç±»ä¼¼äºæ•°ç»„çš„å¯¹è±¡ä¸­ã€‚åœ¨å‡½æ•°å†…ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ‰¾åˆ°ä¼ å…¥çš„å‚æ•°ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">arguments</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
</code></pre></div></div>

<blockquote>
  <p><code class="highlighter-rouge">i</code>æ˜¯åºå·ç¼–å·ï¼Œä»¥<code class="highlighter-rouge">0</code>å¼€å§‹ã€‚å‚æ•°çš„æ•°é‡ç”±<code class="highlighter-rouge">arguments.length</code>è¡¨ç¤ºã€‚</p>
</blockquote>

<hr />

<h2 id="function-parameter--å‡½æ•°å‚æ•°">Function parameter â€“ å‡½æ•°å‚æ•°</h2>

<p>ä»<code class="highlighter-rouge">ECMAScript 6</code>å¼€å§‹ï¼Œæœ‰ä¸¤ä¸ªæ–°çš„ç±»å‹å‚æ•°ï¼šé»˜è®¤å‚æ•°(default parameter)å’Œå‰©ä½™å‚æ•°(rest parameter).</p>

<h3 id="default-parameter">default parameter</h3>

<p>In JavaScript, parameters of functions default to <code class="highlighter-rouge">undefined</code>. ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨å‡½æ•°å¤´è®¾ç½®é»˜è®¤å‚æ•°ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">multiply</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">a</span><span class="o">*</span><span class="nx">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">multiply</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="c1">// 5</span>
</code></pre></div></div>

<h3 id="rest-parameter">rest parameter</h3>

<p>å‰©ä½™å‚æ•°è¯­æ³•å…è®¸å°†ä¸ç¡®å®šæ•°é‡çš„å‚æ•°è¡¨ç¤ºä¸ºæ•°ç»„ã€‚</p>

<p>è¯­æ³•ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="p">...</span><span class="nx">theArgs</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="arrow-functions--ç®­å¤´å‡½æ•°">Arrow functions â€“ ç®­å¤´å‡½æ•°</h2>

<p>An <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions">arrow function expression</a> has a shorter syntax compared to function expressions and lexically binds the <code class="highlighter-rouge">this</code> value.(ç®­å¤´å‡½æ•°è¡¨è¾¾å¼ç›¸æ¯”å‡½æ•°è¡¨è¾¾å¼å…·æœ‰è¾ƒçŸ­çš„è¯­æ³•å¹¶ä»¥è¯æ³•çš„æ–¹å¼ç»‘å®š<code class="highlighter-rouge">this</code>)</p>

<p>ç®­å¤´å‡½æ•°<strong>æ€»æ˜¯åŒ¿åçš„</strong>ã€‚</p>

<p>é€ æˆç®­å¤´å‡½æ•°å¼•å…¥çš„ä¸¤ä¸ªåŸå› ï¼š</p>

<ul>
  <li>æ›´ç®€æ´çš„å‡½æ•°</li>
  <li><code class="highlighter-rouge">this</code></li>
</ul>

<h3 id="æ›´ç®€æ´çš„å‡½æ•°">æ›´ç®€æ´çš„å‡½æ•°</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">[</span>
  <span class="dl">"</span><span class="s2">Hydrogen</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">Helium</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">Lithium</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">Beryllium</span><span class="dl">"</span>
<span class="p">];</span>

<span class="kd">var</span> <span class="nx">a2</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">){</span> <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a2</span><span class="p">);</span> <span class="c1">// logs [ 8, 6, 7, 9 ]</span>

<span class="kd">var</span> <span class="nx">a3</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span> <span class="nx">s</span> <span class="o">=&gt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a3</span><span class="p">);</span> <span class="c1">// logs [ 8, 6, 7, 9 ]</span>
</code></pre></div></div>

<h3 id="thisçš„è¯æ³•">thisçš„è¯æ³•</h3>

<p>åœ¨ç®­å¤´å‡½æ•°å‡ºç°ä¹‹å‰ï¼Œæ¯ä¸€ä¸ªæ–°å‡½æ•°éƒ½é‡æ–°å®šä¹‰äº†è‡ªå·±çš„<code class="highlighter-rouge">this</code>å€¼ã€‚(ä¾‹å¦‚ï¼Œæ„é€ å‡½æ•°çš„ <code class="highlighter-rouge">this</code> æŒ‡å‘äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼›ä¸¥æ ¼æ¨¡å¼ä¸‹çš„å‡½æ•°çš„ <code class="highlighter-rouge">this</code> å€¼ä¸º <code class="highlighter-rouge">undefined</code>ï¼›å¦‚æœå‡½æ•°æ˜¯ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨çš„ï¼Œåˆ™å…¶ <code class="highlighter-rouge">this</code> æŒ‡å‘äº†é‚£ä¸ªè°ƒç”¨å®ƒçš„å¯¹è±¡)</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Person</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// The Person() constructor defines `this` as itself.</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="nx">growUp</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// In nonstrict mode, the growUp() function defines `this` </span>
    <span class="c1">// as the global object, which is different from the `this`</span>
    <span class="c1">// defined by the Person() constructor.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="o">++</span><span class="p">;</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
</code></pre></div></div>

<p>åœ¨<code class="highlighter-rouge">ECMAScript 3/5</code>é‡Œï¼Œé€šè¿‡æŠŠ<code class="highlighter-rouge">this</code>çš„å€¼èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡å¯ä»¥ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Person</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nb">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// Some choose `that` instead of `self`. </span>
                   <span class="c1">// Choose one and be consistent.</span>
  <span class="nb">self</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="nx">growUp</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// The callback refers to the `self` variable of which</span>
    <span class="c1">// the value is the expected object.</span>
    <span class="nb">self</span><span class="p">.</span><span class="nx">age</span><span class="o">++</span><span class="p">;</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ç®­å¤´åŠŸèƒ½æ•æ‰é—­åŒ…ä¸Šä¸‹æ–‡çš„<code class="highlighter-rouge">this</code>å€¼ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä»£ç å·¥ä½œæ­£å¸¸:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">Person</span><span class="p">(){</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="o">++</span><span class="p">;</span> <span class="c1">// |this| properly refers to the person object</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="ç®­å¤´å‡½æ•°çš„è¯­æ³•">ç®­å¤´å‡½æ•°çš„è¯­æ³•</h3>

<p>åŸºç¡€è¯­æ³•ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">param1</span><span class="p">,</span> <span class="nx">param2</span><span class="p">,</span> <span class="err">â€¦</span><span class="p">,</span> <span class="nx">paramN</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">statements</span> <span class="p">}</span>
<span class="p">(</span><span class="nx">param1</span><span class="p">,</span> <span class="nx">param2</span><span class="p">,</span> <span class="err">â€¦</span><span class="p">,</span> <span class="nx">paramN</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">expression</span>
         <span class="c1">// equivalent to:  =&gt; { return expression; }</span>

<span class="c1">// å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåœ†æ‹¬å·æ˜¯å¯é€‰çš„:</span>
<span class="p">(</span><span class="nx">singleParam</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">statements</span> <span class="p">}</span>
<span class="nx">singleParam</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">statements</span> <span class="p">}</span>

<span class="c1">// æ— å‚æ•°çš„å‡½æ•°éœ€è¦ä½¿ç”¨åœ†æ‹¬å·:</span>
<span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">statements</span> <span class="p">}</span>
</code></pre></div></div>

<p>é«˜çº§è¯­æ³•ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// è¿”å›å¯¹è±¡å­—é¢é‡æ—¶åº”å½“ç”¨åœ†æ‹¬å·å°†å…¶åŒ…èµ·æ¥:</span>
<span class="nx">params</span> <span class="o">=&gt;</span> <span class="p">({</span><span class="na">foo</span><span class="p">:</span> <span class="nx">bar</span><span class="p">})</span>

<span class="c1">// æ”¯æŒ Rest parameters å’Œ default parameters:</span>
<span class="p">(</span><span class="nx">param1</span><span class="p">,</span> <span class="nx">param2</span><span class="p">,</span> <span class="p">...</span><span class="nx">rest</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">statements</span> <span class="p">}</span>
<span class="p">(</span><span class="nx">param1</span> <span class="o">=</span> <span class="nx">defaultValue1</span><span class="p">,</span> <span class="nx">param2</span><span class="p">,</span> <span class="err">â€¦</span><span class="p">,</span> <span class="nx">paramN</span> <span class="o">=</span> <span class="nx">defaultValueN</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">statements</span> <span class="p">}</span>

<span class="c1">// å‚æ•°åˆ—è¡¨ä¸­çš„è§£æ„èµ‹å€¼ä¹Ÿæ˜¯è¢«æ”¯æŒçš„</span>
<span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="p">([</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="nx">c</span><span class="p">}</span> <span class="o">=</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">c</span><span class="p">;</span>
<span class="nx">f</span><span class="p">();</span>  <span class="c1">// 6</span>
</code></pre></div></div>

<h2 id="iifeimmediately-invoked-function-expression--ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼">IIFE(Immediately Invoked Function Expression) â€“ ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼</h2>

<p>ä¼ ç»Ÿçš„æ–¹æ³•ï¼Œå‡½æ•°çš„å®šä¹‰å’Œæ‰§è¡Œåˆ†å¼€å†™ã€‚ä¸ºäº†èƒ½å¤Ÿåœ¨å‡½æ•°å®šä¹‰ä¹‹åç«‹å³æ‰§è¡Œï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="highlighter-rouge">IIFE</code>è¿™ç§è¯­æ³•ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}());</span>

<span class="c1">// or</span>
<span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="k">return</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">})();</span>
</code></pre></div></div>

<blockquote>
  <p>ä¸Šé¢è¿™ä¸¤ç§å†™æ³•éƒ½æ˜¯å¯ä»¥çš„ã€‚</p>
</blockquote>

<p>ä¹Ÿå¯ä»¥ä¸º<code class="highlighter-rouge">IIFE</code>ä¼ é€’å‚æ•°ï¼š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">who</span><span class="p">,</span> <span class="nx">when</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">I met </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">who</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> on </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">when</span><span class="p">);</span>
<span class="p">}</span> <span class="p">(</span><span class="dl">"</span><span class="s2">Joe Black</span><span class="dl">"</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()));</span>
</code></pre></div></div>

<p>å‚è€ƒï¼š</p>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Immediately-invoked_function_expression">https://en.wikipedia.org/wiki/Immediately-invoked_function_expression</a></li>
  <li><a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/">http://benalman.com/news/2010/11/immediately-invoked-function-expression/</a></li>
</ul>

<blockquote>
  <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions">æ›´å¤šè§£æå‚è§ï¼š</a></p>
</blockquote>

<p>ç¼–è¾‘å¤‡æ³¨ï¼š</p>

<ul>
  <li>2017-03-07ç¬¬ä¸€æ¬¡ç¼–è¾‘</li>
  <li>2017-03-21ç¬¬äºŒæ¬¡ç¼–è¾‘</li>
</ul>
:ET